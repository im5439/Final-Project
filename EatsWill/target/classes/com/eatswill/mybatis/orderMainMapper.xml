<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="orderMainMapper">

<!-- 해당 아이디의 주문 내역 출력 -->
<select id="getList" parameterType="String"  resultType="com.eatswill.dto.OrderMainDTO">
	select om.orderDate orderDate, om.orderCode orderCode, s.shopname shopName, om.oamount oAmount, data2.menuName, cc.codename orderStatus 
	from ORDERMAIN om, shop s, COMMON_CODE cc, (select LISTAGG(m.menuname, ',') WITHIN GROUP (ORDER BY m.menuname) menuName from ORDERDETAIL ot, MENU m, shop s, (select ordercode from ORDERMAIN  where userId=#{userId}) data1 
	where ot.ORDERCODE=data1.orderCode and ot.menuCode=m.menuCode) data2 
	WHERE om.orderstatus=cc.code 
</select>
</mapper>